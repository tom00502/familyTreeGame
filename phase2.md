第二階段資料填充：策略重點整理1. 核心概念：最小可行族譜 (MVP)不再設定硬性的「代數天花板」，而是由玩家間的關係自然決定邊界。連通性優先：所有在第一階段確認有關係的玩家，必須透過虛擬節點在圖中相連（路徑閉合）。骨架完整：每位玩家節點必須擁有父母節點（視覺支柱）。任務導向：只要關鍵路徑上的節點資訊（姓名、性別）填寫完畢且無衝突，即視為 MVP 完成。2. 關鍵組件一：稱謂與路徑對應表 (Kinship Mapping)這是系統的「生長引擎」，負責將抽象稱謂轉化為圖形路徑。原子動作：P (Parent / 向上), C (Child / 向下), S (Spouse / 水平)。路徑解析範例 (以「堂兄」為例)：方向：爸爸那邊的人。解析路徑：B -> P(男, 父親) -> P(男, 祖父) -> C(男, 伯叔) -> A(本人)。實作技巧：系統採用「獲取或建立 (Get or Create)」邏輯。沿路徑走訪，若節點不存在則建立 ID 並標記為 isVirtual: true。3. 關鍵組件二：提問問題模板表 (Question Templates)這是系統的「溝通介面」，負責將虛擬節點任務轉化為自然語言。任務類型觸發時機提問模板範例節點命名虛擬節點姓名為空「你的 {node_label} 叫什麼名字？」屬性填充已有姓名，生日為空「有人記得 {node_name} 的生日或大約幾歲嗎？」向上追溯需要建立更高階節點「請問 {node_name} 的父親是誰？」節點匯聚嘗試連接兩條不同路徑「玩家 B，你的 {node_label} 是 {known_name} 嗎？」性別/排行視覺排序與邏輯檢核「{node_A} 與 {node_B} 誰的年紀比較大？」4. 系統實作邏輯流程路徑實體化 (Instantiation)：掃描第一階段結果，根據「稱謂路徑表」在後台建立虛擬節點。任務分派 (Dispatching)：將「命名」與「追溯」任務丟入 Task Queue。優先派發給距離目標節點最近的玩家（如：自己的父母由自己填）。節點去重與匯聚 (Deduplication)：當不同玩家提到同一個名字（如「大野狼」）或透過匯聚問題確認身分後，系統合併節點 ID，將路徑導向同一個節點。動態更新：一旦節點有了名字，所有相關問題自動從「你的父親」變更為「金剛狼」，提升沉浸感。5. 待處理的邊界情況 (Edge Cases)多重婚姻/複雜關係：目前 MVP 暫不處理再婚或領養，以一夫一妻制的直系血親為主。同名同姓誤判：若家族中有兩位「王小明」，需透過年齡或配偶資訊進行二次確認，避免錯誤匯聚。衝突標記：若玩家 A 與 B 對同一虛擬節點的資訊（如生日）回答不一致，系統不應卡住，應標記為「衝突」並移交至第三階段驗證處理。
